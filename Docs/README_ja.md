<p align="center">
  <img src="icon.jpg" alt="Glancy App Icon" width="150" style="border-radius: 20px;"/>
</p>

- [English Version](README.md)
- [中文版](Docs/README_zh.md)
- [日本語版](Docs/README_ja.md)

# Glancy

Glancy（グランシー）は、ユーザーに迅速かつ正確な翻訳と使用例を提供するために設計された、プレミアムな多言語辞書アプリです。直感的なインターフェースと先進の言語処理機能により、言語学習者、プロフェッショナル、日常利用者が複数の言語で単語やフレーズをシームレスに調べることができます。

## 概要

Glancy の特徴：
- **多言語翻訳：** 最大3つの選択された言語で、正確な翻訳と使用例を提供します。
- **高度な検索機能：** 画面下部に配置された検索バー（送信ボタン内蔵）で迅速に単語を検索できます。
- **パーソナライズされた言語設定：** 用意されたリストから好みの言語を選択し、メイン画面に表示される言語ボタンや取得される翻訳結果を制御します。
- **クラウド連携体験：** 検索履歴やお気に入り、設定を安全なクラウドサービスを通じて同期し、複数のデバイスで一貫した体験を提供します。
- **ユーザー管理：** シームレスなサインアップ、ログイン、プロフィール管理を実現し、匿名利用も可能です。

## 仕組み

1. **スマートクエリ：**
   単語検索時、Glancy はまずクラウドデータベースからキャッシュされた定義を探します。見つかれば即座に表示し、見つからなければ先進の言語エンジンで翻訳と例文を取得し、クラウドに保存します。
2. **直感的なUI：**
   メイン画面には、トグル可能な言語ボタン、見やすい結果表示エリア、下部に固定された入力バーと送信ボタンが配置されています。
3. **パーソナライズされた体験：**
   設定ページで言語の好みをカスタマイズすると、選択された言語がメイン画面に反映され、検索結果に直接影響を与えます。

## 始め方

App Store から Glancy をダウンロードし、あなたの言語学習体験を向上させるツールとしてぜひご活用ください。
お問い合わせは [support@glancy.com](mailto:support@glancy.com) まで。

## 機能要件

### FR-001 単語検索
**コンテキスト** ユーザーは入力した単語の翻訳と例文を確認したい。
**メインフロー**
1. 検索バーに単語を入力する。
2. LeanCloud のキャッシュを確認する。
3. キャッシュが無ければ DeepSeek に問い合わせる。
4. 結果を LeanCloud に保存し画面に表示する。
**代替フロー** ネットワークエラー時はメッセージを表示し履歴を保存しない。
**事後条件** 単語とタイムスタンプを検索履歴に記録する。
**例外** 空文字が入力された場合は再入力を促す。
#### テストケース
- キャッシュにある "hello" を検索し即時表示。
- キャッシュ無しの場合 DeepSeek を呼び結果を保存。
- ネットワーク障害時はエラー表示し履歴を残さない。

### FR-002 言語設定管理
**コンテキスト** ユーザーは検索結果に表示する言語を選択したい。
**メインフロー**
1. 設定画面で言語を選択する。
2. 最大三言語まで選択できる。
3. 保存すると設定が端末に保存される。
**代替フロー** 三言語を超えた選択は無効。
**事後条件** 言語バーが即時更新される。
**例外** 少なくとも一言語を残す必要がある。
#### テストケース
- 二言語を選択し再起動後も保持。
- 四言語を選ぼうとしても三つまでに制限される。
- 最後の一言語は解除できない。

### FR-003 認証
**コンテキスト** ユーザーはデータ同期のためにログインやログアウトを行う。
**メインフロー**
1. パスワードまたは認証コードでログイン方法を選ぶ。
2. LeanCloud が資格情報を確認しユーザーを返す。
3. 成功するとプロフィール画面が表示される。
**代替フロー** 資格情報が無効な場合はエラーを表示して未ログインのまま。
**事後条件** ログイン状態では検索履歴と設定がクラウドへ同期される。
**例外** ネットワーク障害時は再試行を促す。
#### テストケース
- 正しいパスワードでログインしプロフィールを表示。
- 誤ったコード入力でエラーメッセージを確認。
- オフライン時のログインは再試行を促す。

### FR-004 検索履歴管理
**コンテキスト** ユーザーは最近検索した単語を確認・操作する。
**メインフロー**
1. 成功した検索ごとに `SearchRecord` を保存する。
2. 履歴画面には最新10件まで表示する。
3. タップで再検索、長押しで削除できる。
**代替フロー** なし。
**事後条件** 10件を超えた履歴は自動的に削除される。
**例外** 保存に失敗した場合は無視する。
#### テストケース
- 検索後、履歴に語句が追加される。
- 11件目追加時に最古の記録が削除される。
- 長押しで履歴項目を削除できる。

## 非機能要件

| ID | カテゴリ | 要件 | 指標 / しきい値 |
|----|----------|------|------------------|
| NFR-S01 | セキュリティ | すべての API を HTTPS で呼び出し、キーは plist に保存する。 | ハードコードされた秘密情報が無いことを静的解析で確認 |
| NFR-P01 | パフォーマンス | キャッシュ命中時の応答は 500ms 以内。 | 単体テスト `GlancyTests.swift::test_performance` |
| NFR-R01 | 信頼性 | LeanCloud 操作の月間成功率 99.5% を維持する。 | Sentry ダッシュボード `glancy.reliability` |
### NFR テストケース
- NFR-S01：静的解析で秘密情報が無いことを確認。
- NFR-P01：キャッシュ利用時の応答が 500ms 以内か測定。
- NFR-R01：Sentry で月間成功率 99.5% を確認。

## トレーサビリティマトリクス

| 要件 | 単体テスト | 統合 | E2E / BDD |
|------|-----------|------|-----------|
| FR-001 | `GlancyTests/GlancyTests.swift::test_search_word` | – | – |
| FR-002 | `GlancyTests/GlancyTests.swift::test_language_preference` | – | – |
| FR-003 | `GlancyTests/GlancyTests.swift::test_authentication` | – | – |
| FR-004 | `GlancyTests/GlancyTests.swift::test_history` | – | – |
| NFR-P01 | `GlancyTests/GlancyTests.swift::test_performance` | N/A | `Reports/junit.xml` |

## 要件記述ガイド

### 機能要件

各 FR は次の構造で記述します。

* **コンテキスト** – 利用シーンの概要
* **メインフロー** – 番号付き手順
* **代替フロー** – 分岐や例外の流れ
* **事後条件** – 成功時の状態
* **例外** – エラー処理

FR の直後に Gherkin `Given/When/Then` 形式の受け入れ基準を記載し、ハッピーパス、境界、ネガティブを網羅します。

### 非機能要件

NFR は「ID」「カテゴリ」「要件」「指標 / しきい値」の列を持つ表でまとめ、続けて1文で目的を説明します。

### トレーサビリティマトリクス

各要件 ID を単体・統合・E2E テストに対応付ける表を維持します。すべての行に少なくとも1つのテストへの参照が必要です。テスト変更時は必ず更新してください。

### テストケース記述ガイドライン
- 箇条書きや表形式で簡潔に書く。
- 各要件にハッピー、境界、ネガティブの三種を含める。
- 先頭に要件IDを付ける（例: FR-001-T1）。
- 能動態で25語以内に収める。
- 受け入れ基準とトレーサビリティに対応させる。
